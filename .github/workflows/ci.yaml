# This is a basic workflow to help you get started with Actions

name: CI

name: Manually triggered workflow
on:
  workflow_dispatch:
    inputs:
      image:
        description: Image to scan
        required: true
        default: alpine:3.7

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
      - uses: sysdiglabs/scan-action@use-inline-scan-v2 

      - name: Scan image
        id: scan
        uses: sysdiglabs/scan-action@use-inline-scan-v2 
        with:
          image-tag: "alpine:3.7"
          sysdig-secure-token: ${{ secrets.SYSDIG_SECURE_TOKEN }}
          pull-from-registry: true

        - uses: github/codeql-action/upload-sarif@v1
        with:
          sarif_file: ${{ steps.scan.outputs.sarifReport }}
